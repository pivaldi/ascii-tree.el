#+title: ascii-tree-export
#+author: Philippe IVALDI
#+language: en

Export an =org-mode= or =markdown= buffer as an ASCII tree into a dedicated buffer.

* Example

** Without Content

Given this org file:

#+begin_src org
,* Emacs
,** Editor -- core editing
,** Org-mode
,*** Capture
,*** Agenda
,** Magit
,* Vim
,** Normal mode
,** Insert mode
#+end_src

Running =M-x ascii-tree-export= produces:

#+begin_example
├── Emacs
│   ├── Editor # core editing
│   ├── Org-mode
│   │   ├── Capture
│   │   └── Agenda
│   └── Magit
└── Vim
    ├── Normal mode
    └── Insert mode
#+end_example

The same command works on a =.md= file…

** With Content

See file [[file:README.txt][README.txt]] exported from this README.org…

* Installation

** Manual

Clone or download =ascii-tree-export.el= and add it to your load path:

#+begin_src emacs-lisp
(add-to-list 'load-path "/path/to/ascii-tree-export")
(require 'ascii-tree-export)
#+end_src

** package-vc (Emacs 29+)

#+begin_src emacs-lisp
(package-vc-install "https://github.com/pivaldi/ascii-tree-export")
#+end_src

** use-package + straight

#+begin_src emacs-lisp
(use-package ascii-tree-export
  :straight (:host github :repo "pivaldi/ascii-tree-export"))
#+end_src

* Usage

Open any =.org= or =.md= file and run:

#+begin_example
M-x ascii-tree-export
#+end_example

A buffer named =*ascii-tree-export-FILENAME*= opens with the tree output.

* Converting Tree Text to Org-mode

=ascii-tree-import= does the reverse: converts tree-structured text (like output
from the =tree= command) into org-mode format.

** Usage

Open any buffer containing tree-structured text (or select a region), then run:

#+begin_example
M-x ascii-tree-import
#+end_example

A buffer named =*ascii-tree-import-result*= opens with org-mode formatted content.

** Example

Given this tree text:

#+begin_example
├── service-manager/
│   ├── go.work # Go workspace
│   │   use (./contracts ./services/...)
│   └── contracts/ -- Unified module
│       └── go.mod
#+end_example

Running =M-x ascii-tree-import= produces:

#+begin_src org
,* service-manager/
,** go.work -- Go workspace
use (./contracts ./services/...)

,** contracts/ -- Unified module
,*** go.mod
#+end_src

** Subtitle Detection

The converter detects both subtitle formats:
- =# subtitle= (tree command convention)
- =-- subtitle= (ascii-tree-export convention)

Both are converted to org's =-- separator= format.

** Real-World Example with Round-Trip

The =tests/= directory contains a complete example demonstrating round-trip conversion:

- [[file:tests/mock.txt][tests/mock.txt]] - Tree-structured project architecture (310 lines)
- [[file:tests/mock.org][tests/mock.org]] - Converted org-mode format

This example demonstrates:

1. *Import* (=M-x ascii-tree-import=): Converts =mock.txt= tree to org-mode
2. *Export* (=M-x ascii-tree-export=): Converts the org file back to tree format
3. *Round-trip preservation*: Structure and depth are preserved through the cycle

*** Key Features Demonstrated

*Alignment space handling*: The original tree may contain visual alignment spaces
for readability. These are automatically ignored during depth calculation:

#+begin_example
│   ├── definitions/          # Contract Definitions
│   │   │                     # ZERO dependencies (alignment spaces ignored)
│   │   ├── serviceasvc/      # Service A public API
│   │   │   │                 # Dependencies: ZERO (alignment spaces)
#+end_example

*Deep content nesting*: Content can be multiple levels deeper than its parent
headline, and this depth offset is preserved through round-trip conversion.

*Inline comments*: Lines starting with =#= are treated as org comments but their
depth information is preserved using leading spaces in the org representation.

* Configuration

** Subtitle separator

Headlines of the form =Title -- Subtitle= are rendered as =Title # Subtitle= in
the tree. The separator string is configurable:

#+begin_src emacs-lisp
;; Default: " -- "
(setq ascii-tree-export-subtitle-separator " -- ")

;; Legacy pipe convention
(setq ascii-tree-export-subtitle-separator " | ")
#+end_src

* Supported formats

| Format      | Export | Convert | Content Support |
|-------------+--------+---------+-----------------|
| Org-mode    | yes    | yes     | Full (AST)      |
| Markdown    | yes    | —       | Basic (text)    |
| Tree text   | —      | yes     | Plain text      |

Org-mode content is extracted via =org-element=, giving full structural fidelity.
Markdown content is collected as raw text lines between headings (no AST parsing).

* Requirements

- Emacs 29.1+
- [[https://jblevins.org/projects/markdown-mode/][markdown-mode]] 2.4+

* License

MIT License.
